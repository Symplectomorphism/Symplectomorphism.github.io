<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Week 1: Basics of Optimization – Satici Lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../teaching/grad_courses/deep_learning/week02.html" rel="next">
<link href="../../../teaching/grad_courses/deep_learning/index.html" rel="prev">
<link href="../../../images/monogram_solid-cmyk.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-eef78bce6e6d37c27bc985c3ac861da9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<meta name="shinylive:serviceworker_dir" content="../../..">
<script src="../../../site_libs/quarto-contrib/shinylive-0.10.7/shinylive/load-shinylive-sw.js" type="module"></script>
<script src="../../../site_libs/quarto-contrib/shinylive-0.10.7/shinylive/run-python-blocks.js" type="module"></script>
<link href="../../../site_libs/quarto-contrib/shinylive-0.10.7/shinylive/shinylive.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/shinylive-quarto-css/shinylive-quarto.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>
window.MathJax = {
  loader: {
    load: ['[tex]/boldsymbol', '[tex]/mathtools']
  },
  tex: {
    packages: {'[+]': ['boldsymbol', 'mathtools']}
  }
};
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Week 1: Basics of Optimization – Satici Lab">
<meta property="og:description" content="Research website for the Satici Lab">
<meta property="og:image" content="https://Symplectomorphism.github.io/teaching/grad_courses/deep_learning/assets/images/The_Cat.jpg">
<meta property="og:site_name" content="Satici Lab">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../images/monogram_solid-blk.png" alt="" class="navbar-logo light-content">
    <img src="../../../images/monogram_solid-blk.png" alt="" class="navbar-logo dark-content">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Satici Lab</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../research/index.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../publications.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../../teaching/index.html" aria-current="page"> 
<span class="menu-text">Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../people/index.html"> 
<span class="menu-text">People</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../positions/index.html"> 
<span class="menu-text">Positions</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-more" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">More</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-more">    
        <li>
    <a class="dropdown-item" href="../../../about.html">
 <span class="dropdown-text">About</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../chiasson/index.html">
 <span class="dropdown-text">John Chiasson</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/symplectomorphism"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text">Github</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../teaching/robotics.html">Graduate Courses</a></li><li class="breadcrumb-item"><a href="../../../teaching/grad_courses/deep_learning/index.html">Deep Learning</a></li><li class="breadcrumb-item"><a href="../../../teaching/grad_courses/deep_learning/week01.html">Basics of Optimization</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
  <div id="quarto-announcement" data-announcement-id="308118796d112337113ef5a3a3b7ad7a" class="alert alert-primary hidden"><i class="bi bi-info-circle quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p>Currently looking for PhD students on robotics, control, and machine learning! Please see the <a href="../../../positions/index.html">positions</a> tab.</p>
</div><i class="bi bi-x-lg quarto-announcement-action"></i></div>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../teaching/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Teaching</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Graduate Courses</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../teaching/robotics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Robotics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../teaching/optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimization</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../teaching/grad_courses/deep_learning/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deep Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../teaching/grad_courses/deep_learning/week01.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Basics of Optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../teaching/grad_courses/deep_learning/week02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intro to Learning</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Undergraduate Courses</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../teaching/kinematics_and_dynamics_machines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kinematics and Machine Dynamics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../teaching/smac.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">System Modeling and Control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../teaching/mechatronics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mechatronics</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">
<div style="visibility: hidden; position: absolute; top: 0; left: 0; width: 0; height: 0; overflow: hidden;">
$$
% Define your custom commands here
\newcommand{\bmat}[1]{\begin{bmatrix}#1\end{bmatrix}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\S}{\mathbb{S}}
\newcommand{\norm}[2]{\|{#1}\|_{{}_{#2}}}
\newcommand{\pd}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\pdd}[2]{\frac{\partial^2 #1}{\partial #2^2}}
\newcommand{\vectornorm}[1]{\left|\left|#1\right|\right|}
\newcommand{\abs}[1]{\left|{#1}\right|}
\newcommand{\mbf}[1]{\mathbf{#1}}
\newcommand{\mc}[1]{\mathcal{#1}}
\newcommand{\bm}[1]{\boldsymbol{#1}}
\newcommand{\nicefrac}[2]{{}^{#1}\!/_{\!#2}}
\newcommand{\argmin}{\operatorname*{arg\,min}}
$$
</div>

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../teaching/robotics.html">Graduate Courses</a></li><li class="breadcrumb-item"><a href="../../../teaching/grad_courses/deep_learning/index.html">Deep Learning</a></li><li class="breadcrumb-item"><a href="../../../teaching/grad_courses/deep_learning/week01.html">Basics of Optimization</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Week 1: Basics of Optimization</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="page-columns page-full">
<div class="tabset-margin-container"></div><div class="panel-tabset page-columns page-full">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Theory</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Examples</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">JAX Resources</a></li></ul>
<div class="tab-content page-columns page-full">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div style="max-width: 800px;">
<section id="taylor-series-gradient-and-hessian" class="level3">
<h3 class="anchored" data-anchor-id="taylor-series-gradient-and-hessian">Taylor Series, Gradient, and Hessian</h3>
<p>Let us consider a local extremum (minimum or maximum) of a function <span class="math inline">\(f: \mathbb{R}^2 \to \mathbb{R}\)</span>, <span class="math inline">\(\bm{w} = (w_1, w_2) \mapsto f(\bm{w}) = f(w_1, w_2)\)</span>. We perform a power series (Taylor) expansion around <span class="math inline">\(\bm{w} = \bm{w}^{(0)}\)</span> and just keep the first three terms to obtain</p>
<p><span id="eq-taylor"><span class="math display">\[
f(\bm{w}) \approx f\left(\bm{w}^{(0)}\right) + \nabla_wf\left(\bm{w}^{(0)}\right)^\top \delta \bm{w} + \frac{1}{2} \delta \bm{w}^\top \bm{H}_f(\bm{w}) \delta \bm{w},
\tag{1}\]</span></span></p>
<p>where the <em>gradient</em> of <span class="math inline">\(f\)</span> is defined by <span class="math inline">\(\nabla_w f(\bm{w}) = \bmat{\pd{f}{w_1}(\bm{w}) &amp; \pd{f}{w_2}(\bm{w})}^\top\)</span>, <span class="math inline">\(\delta \bm{w} = \bm{w} - \bm{w}^{(0)}\)</span>, and <span class="math inline">\(\bm{H}_f(\bm{w})\)</span> is the <em>Hessian</em> matrix of second derivatives:</p>
<p><span class="math display">\[
\bm{H}_f(\bm{w}) = \bmat{
    \pdd{f}{w_1}(\bm{w}) &amp; \frac{\partial^2 f}{\partial w_1 \partial w_2}(\bm{w}) \\
    \frac{\partial^2 f}{\partial w_2 \partial w_1}(\bm{w}) &amp; \pdd{f}{w_2}(\bm{w})
}(\bm{w}).
\]</span></p>
<p>If <span class="math inline">\(\bm{w}^{(0)}\)</span> is an extremum, then <span class="math inline">\(\nabla_w f\left(\bm{w}^{(0)}\right) =
\bm{0}\)</span>, so at such a point, the linear term in <a href="#eq-taylor" class="quarto-xref">Equation&nbsp;1</a> vanishes. Therefore <span class="math inline">\(\bm{w}^{(0)}\)</span> is a local minimum if and only if the Hessian is <em>positive definite</em>. By the same token, it is a local maximum if and only if the Hessian is <em>negative definite</em>.</p>
</section>
<section id="gradient-descentascent" class="level3">
<h3 class="anchored" data-anchor-id="gradient-descentascent">Gradient Descent/Ascent</h3>
<p>For complicated functions, such as neural nets, it is difficult to solve <span class="math inline">\(\nabla_w f\left(\bm{w}^{(0)}\right) = \bm{0}\)</span> for <span class="math inline">\(\bm{w}^{(0)}\)</span>. Instead, we start at a random point <span class="math inline">\(\bm{w}^{(1)}\)</span> and search for where <span class="math inline">\(\nabla f = \bm{0}\)</span>. To do this, we use the first-order approximation</p>
<p><span class="math display">\[
f\left( \bm{w}^{n+1} \right) \approx f\left( \bm{w}^{n} \right) + \nabla_w f\left(\bm{w}^{(n)}\right)^\top \delta \bm{w}^{(n)},
\]</span></p>
<p>where <span class="math inline">\(\delta \bm{w}^{(n)} = \bm{w}^{(n+1)} - \bm{w}^{(n)}\)</span>. Then with <span class="math inline">\(\eta &gt; 0\)</span>, we set <span class="math inline">\(\bm{w}^{(n+1)}\)</span> according to</p>
<p><span class="math display">\[
\bm{w}^{(n+1)} := \bm{w}^{(n)} \mp \eta \nabla_w f\left( \bm{w}^{(n)}\right).
\]</span></p>
<p>Depending on the sign on the right-hand side of this equation, this forces <span class="math inline">\(f\)</span> to decrease or increase, respectively. Indeed, computing the change in <span class="math inline">\(f\)</span> after one iteration, we obtain</p>
<p><span class="math display">\[
\begin{equation}
\begin{split}
\Delta f \triangleq f\left(\bm{w}^{(n+1)}\right) - f\left(\bm{w}^{(n)}\right) &amp;=
\nabla_w f\left( \bm{w}^{(n)} \right) \delta \bm{w}^{(n)} \\
&amp;= \mp \eta \nabla_w f\left( \bm{w}^{(n)} \right)^\top \nabla_w f\left( \bm{w}^{(n)} \right) \\
&amp;= \mp \eta \norm{\nabla_w f\left( \bm{w}^{(n)} \right)}{}^2 \lessgtr 0
\end{split}
\end{equation}
\]</span></p>
</section>
<section id="symmetric-and-positive-definite-matrices" class="level3">
<h3 class="anchored" data-anchor-id="symmetric-and-positive-definite-matrices">Symmetric and Positive Definite Matrices</h3>
<div id="def-sym" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (Symmetric Matrix)</strong></span> A matrix <span class="math inline">\(\bm{Q} \in \R^{n\times n}\)</span> is <em>symmetric</em> if</p>
<p><span class="math display">\[ \bm{Q}^\top = \bm{Q}. \]</span></p>
<p>The symbol for symmetric matrices of dimension <span class="math inline">\(n\)</span> is <span class="math inline">\(\S_n\)</span>.</p>
</div>
<div id="def-psd" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2 (Positive Semidefinite Matrix)</strong></span> A matrix <span class="math inline">\(\bm{Q} \in \S_n\)</span> is <em>positive semidefinite</em> if for all <span class="math inline">\(\bm{x} \in \R^n\)</span>,</p>
<p><span class="math display">\[ \bm{x}^\top \bm{Q x} \geq 0. \]</span></p>
</div>
<div id="def-pd" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3 (Positive Definite Matrix)</strong></span> A matrix <span class="math inline">\(\bm{Q} \in \S_n\)</span> is <em>positive definite</em> if for all <span class="math inline">\(\bm{x} \in \R^n\)</span> such that <span class="math inline">\(\bm{x} \neq \bm{0}\)</span>,</p>
<p><span class="math display">\[ \bm{x}^\top \bm{Q x} &gt; 0. \]</span></p>
</div>
<div id="def-nd" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4 (Negative (Semi)Definite Matrix)</strong></span> A matrix <span class="math inline">\(\bm{Q} \in \S_n\)</span> is <em>negative (semi)definite</em> if its additive inverse, <span class="math inline">\(-\bm{Q}\)</span>, is positive (semi)definite.</p>
</div>
</section>
<section id="least-squares-identification" class="level3">
<h3 class="anchored" data-anchor-id="least-squares-identification">Least Squares Identification</h3>
<p>Given <span class="math inline">\(y(x) = \sin{x}\)</span>, <span class="math inline">\(-\pi \leq x \leq \pi\)</span>, find the parameters <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, <span class="math inline">\(c\)</span>, <span class="math inline">\(d\)</span>, such that</p>
<p><span class="math display">\[
y_P(x) = a + bx + cx^s + dx^3
\]</span></p>
<p>is a “good” approximation to <span class="math inline">\(y(x) = \sin{x}\)</span>. Let</p>
<p><span class="math display">\[
\bm{x} = \bmat{x_1 = -\pi &amp; x_2 &amp; \cdots &amp; x_{n-1} &amp; x_n = \pi}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\bm{y} = \sin{\bm{x}} = \bmat{\sin{x_1} = 0 &amp; \sin{x_2} &amp; \cdots &amp; \sin{x_{n-1}} &amp; \sin{x_n} = 0}.
\]</span></p>
<p>Then, we want to find <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, <span class="math inline">\(c\)</span>, <span class="math inline">\(d\)</span> such that</p>
<p><span class="math display">\[
\underbrace{
\bmat{
    y_1 \\ y_2 \\ \vdots \\ y_n
}}_{\bm{Y}\in \R^n} =
\bmat{
    \sin{x_1} \\
    \sin{x_2} \\
    \vdots \\
    \sin{x_n}
} =
\underbrace{\bmat{
    1 &amp; x_1 &amp; x_1^2 &amp; x_1^3 \\
    1 &amp; x_2 &amp; x_2^2 &amp; x_2^3 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
    1 &amp; x_n &amp; x_n^2 &amp; x_n^3
}}_{\bm{W} \in \R^{n \times 4}}
\underbrace{\bmat{
    a \\ b \\ c \\ d
}}_{\bm{P} \in \R^4}
\]</span></p>
<p>Let us define the error vector <span class="math inline">\(\bm{E} := \bm{Y} - \bm{WP}\)</span> and the total error <span class="math inline">\(e: \R^n \to \R\)</span></p>
<p><span class="math display">\[
e(\bm{Y}) := \norm{\bm{E}}{}^2 = \bm{E}^\top \bm{E} = \bm{Y}^\top \bm{Y} - 2 \bm{P}^\top \bm{W}^\top \bm{Y} + \bm{P}^\top \bm{W}^\top\bm{W} \bm{P}.
\]</span></p>
<p>The gradient of the error function is given by</p>
<p><span class="math display">\[
\nabla e(\bm{Y}) = -2 \bm{W}^\top \bm{Y} + 2 \bm{W}^\top\bm{WP} = -2\bm{W}^\top (\bm{Y} - \bm{WP}) = -2\bm{W}^\top\bm{E}.
\]</span></p>
<p>Setting this equal to zero, we obtain a linear equation in <span class="math inline">\(\bm{P}\)</span>, whose solution is given by</p>
<p><span class="math display">\[
\bm{P}^* = \left( \bm{W}^\top \bm{W} \right)^{-1} \bm{W}^\top \bm{Y}.
\]</span></p>
<p>Note that <span class="math inline">\(\bm{W}^\top \bm{W} \in \S_4\)</span> is invertible if and only if <span class="math inline">\(\bm{W}\)</span> has full rank if and only if there are at least <span class="math inline">\(4\)</span> distinct data points in the data set <span class="math inline">\(\bm{x}\)</span>. The iterative solution to this problem is found by picking a guess at a solution, say <span class="math inline">\(\bm{P}^{(0)} = \bm{0}\)</span>, and then update it until convergence according to the first-order difference equation</p>
<p><span id="eq-difference"><span class="math display">\[
\begin{split}
\bm{P}^{(n+1)} = \bm{P}^{(n)} - \eta \nabla e(\bm{Y}) &amp;= \bm{P}^{(n)} + 2\eta\bm{W}^\top\left(\bm{Y} - \bm{W}\bm{P}^{(n)}\right) \\
&amp;= \left(\bm{I} - 2\eta\bm{W}^\top \bm{W}\right)\bm{P}^{(n)} + 2\eta \bm{W}^\top\bm{Y}.
\end{split}
\tag{2}\]</span></span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span><span class="math inline">\(\bm{W}^\top \bm{W}\)</span> is positive definite if <span class="math inline">\(\bm{W}\)</span> has full rank.
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\bm{W}^\top \bm{W}\)</span> is obviously symmetric. Taking an arbitrary <span class="math inline">\(\bm{x} \in \R^4\)</span>, and letting <span class="math inline">\(\bm{v} = \bm{Wx}\)</span> we see that <span class="math display">\[
\bm{x}^\top \left(\bm{W}^\top \bm{W}\right) \bm{x} = \bm{v}^\top \bm{v} = \norm{\bm{v}}{}^2 \geq 0.
\]</span> Finally, observe that <span class="math inline">\(\bm{v} = \bm{0}\)</span> if and only if <span class="math inline">\(\bm{x} = \bm{0}\)</span> since <span class="math inline">\(\bm{W}\)</span> has full rank. <span style="float:right;"><span class="math inline">\(\square\)</span></span></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Continuous Analogue of the Gradient Descent
</div>
</div>
<div class="callout-body-container callout-body">
<p>This difference <a href="#eq-difference" class="quarto-xref">Equation&nbsp;2</a> has an associated differential equation, namely</p>
<p><span class="math display">\[
\dot{\bm{P}} = -\alpha\bm{W}^\top\bm{WP} + \alpha\bm{W}^\top \bm{Y}
\]</span> with <span class="math inline">\(\alpha &gt; 0\)</span>. Since <span class="math inline">\(\bm{W}^\top \bm{W} \succeq 0\)</span>, this is a <em>stable</em> linear time-invariant ordinary differential equation. Hence, its final value can be found by invoking the Final Value Theorem (FVT) from control theory. To apply that, take the Laplace transform of the ODE (with zero initial conditions) to get</p>
<p><span class="math display">\[
s \bm{P}(s) = -\alpha \bm{W}^\top \bm{W} \bm{P}(s) + \frac{\alpha \bm{W}^\top\bm{Y}}{s}
\]</span></p>
<p>After some rearrangement, the FVT yields <span class="math display">\[
\lim_{t \to \infty} \bm{P}(t) = \lim_{s \to 0} s \bm{P}(s) = \lim_{s \to 0} s \left(s\bm{I} + \alpha \bm{W}^\top \bm{W}\right)^{-1}\frac{\alpha \bm{W}^\top \bm{Y}}{s}
= \left(\bm{W}^\top\bm{W}\right)^{-1}\bm{W}^\top\bm{Y}.
\]</span></p>
</div>
</div>
</section>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<section id="infinitely-many-extrema" class="level3">
<h3 class="anchored" data-anchor-id="infinitely-many-extrema">Infinitely-Many Extrema</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Because JAX is not yet compatible with WebAssembly (browser-based Python), this example uses standard Numpy and the analytical gradient formula.</p>
</div>
</div>
<pre class="shinylive-python" data-engine="python"><code>#| '!! shinylive warning !!': |
#|   shinylive does not work in self-contained HTML documents.
#|   Please set `embed-resources: false` in your metadata.
#| standalone: true
#| viewerHeight: 675

from shiny import App, render, ui
import numpy as np
import matplotlib.pyplot as plt

# 1. Define Math Functions (Using NumPy instead of JAX)
def C(x): 
    return 0.5 * (np.cos(x[0])**2 + np.sin(x[1])**2)

def grad_C(x):
    # Analytical gradient derived from C(x)
    return np.array([
        -0.5 * 2 * np.cos(x[0]) * np.sin(x[0]), # dx0: -cos*sin
         0.5 * 2 * np.sin(x[1]) * np.cos(x[1])  # dx1:  sin*cos
    ])

# 2. Gradient Descent Logic
def run_gradient_descent(x0, eta, n_iter=50):
    x = np.array(x0, dtype=np.float64)
    path = [x.copy()]
    
    for _ in range(n_iter):
        g = grad_C(x)
        x = x - eta * g
        path.append(x.copy())
        
    return np.array(path)

# 3. Shiny UI
app_ui = ui.page_fluid(
    ui.layout_sidebar(
        ui.sidebar(
            ui.h4("Parameters"),
            ui.input_slider("lr", "Learning Rate (η)", 0.0, 2.0, 0.2, step=0.05),
            ui.input_slider("n_iter", "Iterations", 1, 100, 20),
            ui.hr(),
            ui.h5("Start Position"),
            ui.input_slider("x0", "X0 (Start)", -6.0, 6.0, -5.5),
            ui.input_slider("x1", "X1 (Start)", -6.0, 6.0, 2.0),
            open="always",
        ),
        ui.card(
            ui.output_plot("descent_plot")
        )
    )
)

# 4. Server Logic
def server(input, output, session):
    
    @output
    @render.plot
    def descent_plot():
        # A. Setup Background Contour
        pi = np.pi
        xrange = np.linspace(-2.5*pi, 2.5*pi, 100)
        yrange = np.linspace(-2.5*pi, 2.5*pi, 100)
        xx, yy = np.meshgrid(xrange, yrange)
        
        # Calculate Z for contour using vectorized numpy
        # Note: We construct input manually for broadcasting
        Z = 0.5 * (np.cos(xx)**2 + np.sin(yy)**2)

        # B. Run Algorithm based on inputs
        start_pos = [input.x0(), input.x1()]
        path = run_gradient_descent(start_pos, input.lr(), input.n_iter())

        # C. Plotting
        fig, ax = plt.subplots(figsize=(6,6))
        
        # Plot Contour
        c = ax.contourf(xx, yy, Z, levels=25, cmap='viridis', alpha=0.6)
        plt.colorbar(c, ax=ax, label='Cost C(x)')
        
        # Plot Trajectory
        ax.plot(path[:,0], path[:,1], 'r.-', linewidth=2, markersize=6, label='Gradient Path')
        ax.plot(path[0,0], path[0,1], 'ko', markersize=9, label='Start')
        ax.plot(path[-1,0], path[-1,1], 'w*', markersize=12, markeredgecolor='k', label='End')

        # Place text at 5% x, 95% y (Top Left), relative to axes dimensions
        formula_text = r"$C(x) = \frac{1}{2} (\cos^2(x_0) + \sin^2(x_1))$"
        ax.text(0.05, 0.95, formula_text, transform=ax.transAxes, 
                fontsize=14, verticalalignment='top',
                bbox=dict(boxstyle='round', facecolor='white', alpha=0.9))
       
        ax.set_title(f"Gradient Descent (η = {input.lr()})")
        ax.set_xlabel('$x_0$')
        ax.set_ylabel('$x_1$')
        ax.legend(loc='lower right')
        
        return fig

app = App(app_ui, server)</code></pre>
</section>
<section id="least-squares-closed-form-vs.-gradient-descent" class="level3">
<h3 class="anchored" data-anchor-id="least-squares-closed-form-vs.-gradient-descent">Least Squares: Closed-Form vs.&nbsp;Gradient Descent</h3>
<p>This interactive application demonstrates <strong>Least Squares Identification</strong> as described in the provided notes. We aim to approximate <span class="math inline">\(y = \sin(x)\)</span> using a 3rd-degree polynomial:</p>
<p><span class="math display">\[ y_P(x) = a + bx + cx^2 + dx^3 \]</span></p>
<p>We compare two methods:</p>
<ol type="1">
<li><strong>Closed Form:</strong> The analytical solution <span class="math inline">\(\bm{P}^* = \left(\bm{W}^\top \bm{W}\right)^{-1} \bm{W}^\top \bm{Y}\)</span>.</li>
<li><strong>Gradient Descent:</strong> Iteratively minimizing the squared error <span class="math inline">\(e\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Taylor Series Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Taylor series for <span class="math inline">\(\sin(x)\)</span> is <span class="math inline">\(x - \frac{x^3}{6} + \dots\)</span>. Therefore, we expect our coefficients to converge near: <span class="math inline">\(a=0, b=1, c=0, d=-\nicefrac{1}{6}\)</span>.</p>
</div>
</div>
<pre class="shinylive-python" data-engine="python"><code>#| '!! shinylive warning !!': |
#|   shinylive does not work in self-contained HTML documents.
#|   Please set `embed-resources: false` in your metadata.
#| standalone: true
#| viewerHeight: 925

from shiny import App, render, ui, reactive
import numpy as np
import matplotlib.pyplot as plt

# 1. Setup Data (Fixed range as per PDF)
# Generate n points between -pi and pi
n = 100
x_data = np.linspace(-np.pi, np.pi, n)
y_data = np.sin(x_data)

# Construct W matrix (Design Matrix) [1, x, x^2, x^3]
# As defined in the PDF
W = np.column_stack([
    np.ones_like(x_data), 
    x_data, 
    x_data**2, 
    x_data**3
])

# 2. Closed Form Solution (The "Best" fit)
# P* = (W.T @ W)^-1 @ W.T @ Y
WtW = W.T @ W
WtY = W.T @ y_data
P_closed = np.linalg.solve(WtW, WtY) # More stable than inv()

# 3. Gradient Descent Implementation
def run_gd_linear_regression(W, Y, learning_rate, epochs):
    # Initialize coefficients [a, b, c, d] to zeros
    P = np.zeros(4)
    
    # Track error history
    errors = []
    
    # Loop
    for _ in range(epochs):
        # Calculate Prediction: Y_pred = W @ P
        Y_pred = W @ P
        
        # Calculate Error Vector: (Y - Y_pred)
        error = Y - Y_pred
        
        # Calculate Gradient (derived in PDF):
        # dE/dP = -2 * W.T @ (Y - W @ P)
        gradient = -2 * W.T @ error
        
        # Update Weights: P_new = P_old - eta * gradient
        P = P - learning_rate * gradient
        
        # Store Sum Squared Error
        sse = np.sum(error**2)
        errors.append(sse)
        
    return P, errors

# 4. Shiny UI
app_ui = ui.page_fluid(
    ui.layout_sidebar(
        ui.sidebar(
            ui.h4("Hyperparameters"),
            
            # Note: Polynomial features grow large (x^3 approx 27). 
            # Gradients are huge, so Learning Rate must be tiny.
            ui.input_slider("lr", "Learning Rate", 0.000001, 0.0001, 0.00001, step=0.000001, sep=""),
            ui.input_slider("epochs", "Iterations", 0, 5000, 100, step=100),
            
            ui.hr(),
            ui.h5("Coefficients (a,b,c,d)"),
            ui.output_text_verbatim("coeff_display"),
            
            ui.hr(),
            ui.input_action_button("reset", "Reset / Re-run"),
            open="always",
        ),
        ui.card(
            ui.output_plot("main_plot")
        )
    )
)

# 5. Server Logic
def server(input, output, session):
    
    @reactive.Calc
    def perform_gd():
        # Re-run when button is clicked or inputs change
        input.reset() 
        
        lr = input.lr()
        epochs = input.epochs()
        
        P_gd, error_history = run_gd_linear_regression(W, y_data, lr, epochs)
        return P_gd, error_history

    @output
    @render.text
    def coeff_display():
        P_gd, _ = perform_gd()
        
        # Format for display
        return (
            f"--- Closed Form ---\n"
            f"a: {P_closed[0]:.4f}\n"
            f"b: {P_closed[1]:.4f}\n"
            f"c: {P_closed[2]:.4f}\n"
            f"d: {P_closed[3]:.4f}\n\n"
            f"--- Gradient Descent ---\n"
            f"a: {P_gd[0]:.4f}\n"
            f"b: {P_gd[1]:.4f}\n"
            f"c: {P_gd[2]:.4f}\n"
            f"d: {P_gd[3]:.4f}"
        )

    @output
    @render.plot
    def main_plot():
        P_gd, error_history = perform_gd()
        
        # Generate Predictions
        y_pred_closed = W @ P_closed
        y_pred_gd = W @ P_gd
        
        # Error metrics
        mse_closed = np.mean((y_data - y_pred_closed)**2)
        mse_gd = np.mean((y_data - y_pred_gd)**2)

        # Plotting
        fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(5, 10))
        
        # Plot 1: Curve Fitting
        ax1.plot(x_data, y_data, 'k-', alpha=0.3, linewidth=4, label='True sin(x)')
        ax1.plot(x_data, y_pred_closed, 'b--', linewidth=2, label=f'Closed Form (MSE: {mse_closed:.4f})')
        ax1.plot(x_data, y_pred_gd, 'r-', label=f'Gradient Descent (MSE: {mse_gd:.4f})')
        
        ax1.set_title(f"Polynomial Fit (Iter: {input.epochs()})")
        ax1.set_xlabel("x")
        ax1.set_ylabel("y")
        ax1.legend()
        ax1.grid(True, alpha=0.3)
        
        # Plot 2: Error Curve
        if len(error_history) &gt; 0:
            ax2.plot(error_history)
            ax2.set_title("Sum Squared Error over Iterations")
            ax2.set_xlabel("Epoch")
            ax2.set_ylabel("Error (SSE)")
            ax2.set_yscale('log') # Log scale helps visualize convergence
            ax2.grid(True, alpha=0.3)
        
        return fig

app = App(app_ui, server)</code></pre>
</section>
</div>
<div id="tabset-1-3" class="tab-pane page-columns page-full" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Embedding these Jupyter Notebooks makes the website sluggish, so please download them and open locally.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="assets/images/The_Cat.jpg" class="img-fluid figure-img column-body-right"></p>
<figcaption>Save this image as “The_Cat.jpg”</figcaption>
</figure>
</div>
<a href="../../../teaching/grad_courses/deep_learning/assets/notebooks/chapter5_jit.html" download="chapter5_jit.ipynb" class="btn btn-primary" role="button">
    <i class="bi bi-download"></i> JAX JIT Compilation (.ipynb)
</a>
<a href="../../../teaching/grad_courses/deep_learning/assets/notebooks/chapter9_prng.html" download="chapter9_prng.ipynb" class="btn btn-primary" role="button">
    <i class="bi bi-download"></i> JAX Random Numbers (.ipynb)
</a>
<a href="../../../teaching/grad_courses/deep_learning/assets/notebooks/chapter10.html" download="chapter10.ipynb" class="btn btn-primary" role="button">
    <i class="bi bi-download"></i> JAX PyTrees (.ipynb)
</a>
</div>
</div>
</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/Symplectomorphism\.github\.io\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../../teaching/grad_courses/deep_learning/index.html" class="pagination-link" aria-label="Deep Learning">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Deep Learning</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../../teaching/grad_courses/deep_learning/week02.html" class="pagination-link" aria-label="Intro to Learning">
        <span class="nav-page-text">Intro to Learning</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>